<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>India Media</title>
  <meta name="description" content="India Media is a tricolor-themed video platform. Earn rewards by uploading videos, gaining 100 subscribers and 1000 views. Show your talent and make every view count!">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="indianmedia.png" />

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body { 
      font-family: Arial, sans-serif;
      margin: 0; 
      padding: 0; 
      background-color: #fff;
      padding-bottom: 60px; 
    }

    /* Header */
    header { 
      background: linear-gradient(to right, #FF9933, #FFFFFF, #138808);
      color: #000; 
      padding: 6px 12px; 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      position: fixed;
      top: 0; left: 0; right: 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      z-index: 1000;
    }

    .logo h1 { 
      margin: 0; 
      font-size: 22px; 
      font-weight: bold;
    }
    .logo .india { color: #d44401; }
    .logo .media { color: #138808; }
    .logo .chakra { color: #000080; font-size: 18px; }

    /* Search */
    .search-icon {
      font-size: 20px;
      cursor: pointer;
      color: #000;
      margin: 0 12px;
      transition: transform 0.2s ease;
    }
    .search-icon:hover {
      transform: scale(1.2);
      color: #000080;
    }

    /* Menu Button */
    .menu-button {
      font-size: 24px;
      cursor: pointer;
      background: none;
      border: none;
      outline: none;
      color: #000080;
    }

    /* Video list */
    .video-list { 
      padding: 80px 20px 20px; 
      display: flex; 
      flex-direction: column; 
      gap: 20px; 
    }
    .video-item { 
      display: flex; 
      flex-direction: column; 
      border: 2px solid #138808; 
      border-radius: 10px; 
      overflow: hidden; 
      background: #fff8f0; 
      transition: transform 0.3s ease;
    }
    .video-item:hover {
      transform: scale(1.02);
    }
    .video-thumbnail img { 
      width: 100%; 
      height: auto;
    }
    .video-info {
    padding: 15px;
    background: linear-gradient(to bottom, #FF9933 0%, #FFFFFF 50%, #138808 100%);
}

    .video-title { font-size: 16px; font-weight: bold; color: #000; }
    .video-meta { font-size: 14px; color: #606060; }

    /* Navigation Menu */
    .nav-menu {
      position: fixed;
      top: 0;
      right: -250px;
      width: 250px;
      height: 100%;
      background: linear-gradient(#FF9933, #fff, #138808);
      transition: right 0.3s ease;
      z-index: 1100;
      padding-top: 60px;
    }
    .nav-menu.active { right: 0; }
    .nav-menu a {
      padding: 15px 20px;
      text-decoration: none;
      color: #000;
      font-size: 18px;
      display: block;
    }
    .nav-menu a:hover {
      background-color: rgba(0,0,0,0.1);
    }

    /* Overlay */
    .overlay {
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.4);
      opacity: 0; visibility: hidden;
      transition: opacity 0.3s ease;
      z-index: 1050;
    }
    .overlay.active { opacity: 1; visibility: visible; }

    /* Bottom Navigation */
    .bottom-nav {
      position: fixed; bottom: 0; left: 0; right: 0;
      height: 60px;
      background: linear-gradient(to right, #FF9933, #fff, #138808);
      display: flex; justify-content: space-around; align-items: center;
      z-index: 1000;
    }
    .bottom-nav a {
      text-decoration: none;
      color: #000;
      font-size: 12px;
      display: flex; flex-direction: column;
      align-items: center;
      font-weight: bold;
    }
    .bottom-nav a.active,
    .bottom-nav a:hover {
      color: #000080;
    }
    .bottom-nav a i { font-size: 20px; margin-bottom: 2px; }

    /* Duration & RegNo */
    .video-thumbnail { position: relative; }
    .video-duration, .regNo {
      position: absolute;
      bottom: 8px; right: 8px;
      background: rgba(0,0,0,0.7);
      color: #fff; font-size: 12px;
      padding: 2px 5px;
      border-radius: 3px;
      font-weight: bold;
    }
    .regNo { top: 8px; bottom: auto; }
  </style>
</head>
<body>

<header>
  <div class="logo">
    <h1>
      <span class="india">India</span> 
      <span class="media">Media</span> 
      <i class="fa-solid fa-circle chakra"></i>
    </h1>
  </div>
  <!-- Center Search -->
  <a href="search.html" class="search-icon">
    <i class="fas fa-search"></i>
  </a>
  <!-- Right Menu Btn -->
  <button class="menu-button" id="menu-button">&#9776;</button>
</header>

<!-- Right Navigation -->
<nav class="nav-menu" id="nav-menu">
  <a href="competition.html">Competition</a>
  <a href="poll.html">Vote</a>
  <a href="live.html">Live</a>
  <a href="customer.html">Support</a>
  <a href="subscription.html">Subscriptions</a>
</nav>

<div class="overlay" id="overlay"></div>

<section class="video-list" id="video-list"></section>

<!-- Bottom Navigation -->
<nav class="bottom-nav">
  <a href="index.html" class="active"><i class="fas fa-home"></i><span>Home</span></a>
  <a href="woow.html"><i class="fas fa-video"></i><span>Shorts</span></a>
  <a href="social.html"><i class="fa-photo-film"></i><span>Posts</span></a>
  <a href="upload.html"><i class="fas fa-upload"></i><span>Upload</span></a>
  <a href="profile.html"><i class="fas fa-user"></i><span>Profile</span></a>
</nav>

<script>
  // Navigation Menu JS
  const menuButton = document.getElementById('menu-button');
  const navMenu = document.getElementById('nav-menu');
  const overlay = document.getElementById('overlay');
  menuButton.addEventListener('click', () => {
    navMenu.classList.add('active');
    overlay.classList.add('active');
  });
  overlay.addEventListener('click', () => {
    navMenu.classList.remove('active');
    overlay.classList.remove('active');
  });
</script>

</body>
</html>
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";
import { formatDistanceToNow } from 'https://cdn.skypack.dev/date-fns';  // Import date-fns for time formatting

const firebaseConfig = {
  apiKey: "AIzaSyCJVvkrxH-U5YlQMpMpO8LjnBkm8gEmSjU",
  authDomain: "look-like-e8819.firebaseapp.com",
  projectId: "look-like-e8819",
  storageBucket: "look-like-e8819.appspot.com",
  messagingSenderId: "976652364108",
  appId: "1:976652364108:web:4fb71e5e6477f31d1b07e9",
  measurementId: "G-RPHVKH612W"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

const videoListElement = document.getElementById('video-list');

// Function to load videos from Firestore
// Function to load videos
async function loadVideos() {
    const storedVideos = sessionStorage.getItem('videos');

    if (storedVideos) {
        // If videos are in session storage, load from there
        const videoData = JSON.parse(storedVideos);
        videoData.forEach(video => {
            displayVideoThumbnail(video.id, video.title, video.thumbnailUrl, video.views, video.timeAgo, video.likes, video.duration, video.regNo);
        });
    } else {
        try {
            const querySnapshot = await getDocs(collection(db, "videos"));
            if (querySnapshot.empty) {
                console.log('No videos found.');
                videoListElement.innerHTML = '<p>No videos available.</p>';
                return;
            }
            const videos = [];
            querySnapshot.forEach(doc => {
                const videoData = doc.data();
                const { title, thumbnailUrl, views = '0', timestamp, likes = '0', duration = 0, regNo = 'N/A' } = videoData;
                const timeAgo = formatTimeAgo(timestamp);
                const video = { id: doc.id, title, thumbnailUrl, views, timeAgo, likes, duration, regNo };
                videos.push(video);
                displayVideoThumbnail(doc.id, title, thumbnailUrl, views, timeAgo, likes, duration, regNo);
            });
            // Store the videos in session storage
            sessionStorage.setItem('videos', JSON.stringify(videos));
        } catch (error) {
            console.error('Error loading videos:', error);
            videoListElement.innerHTML = '<p>Error loading videos. Please try again later.</p>';
        }
    }
}

    

// Replace current state with new URL without reloading
window.history.replaceState(null, '', window.location.href);



// Function to format timeAgo (time since upload)
function formatTimeAgo(timestamp) {
    if (timestamp) {
        const timeAgo = formatDistanceToNow(new Date(timestamp.seconds * 1000), { addSuffix: true });

        // Remove the word "about" if it's present
        return timeAgo.replace(/^about\s/, ''); // This will remove "about " from the start of the string
    }
    return 'N/A'; // Default fallback if no timestamp
}

// Function to display a video thumbnail on the page with regNo
function displayVideoThumbnail(videoId, title, thumbnailUrl, views, timeAgo, likes, durationInSeconds, regNo) {
    const formattedDuration = formatDuration(durationInSeconds);

    const videoItem = document.createElement('div');
    videoItem.className = 'video-item';
    videoItem.innerHTML = `
        <div class="video-thumbnail">
            <img src="${thumbnailUrl}" alt="${title}">
            <span class="video-duration">${formattedDuration}</span>
            <span class="regNo">${regNo}</span> <!-- Displaying regNo -->
        </div>
        <div class="video-info">
            <div class="video-title">${title}</div>
            <div class="video-meta">
                <span>${views} views</span> • 
                <span>${timeAgo}</span> • 
                <span>${likes} likes</span>
            </div>
        </div>
    `;
    videoItem.addEventListener('click', () => {
        window.location.href = `video.html?videoId=${videoId}`;
    });
    videoListElement.appendChild(videoItem);
}

// Function to format seconds to HH:MM:SS or MM:SS
function formatDuration(seconds) {
    const hours = Math.floor(seconds / 3600);
    const minutes = Math.floor((seconds % 3600) / 60);
    const secs = Math.round(seconds % 60); // Round the seconds to 2 digits

    const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;
    const formattedSeconds = secs < 10 ? `0${secs}` : secs;

    if (hours > 0) {
        const formattedHours = hours < 10 ? `0${hours}` : hours;
        return `${formattedHours}:${formattedMinutes}:${formattedSeconds}`;
    } else {
        return `${formattedMinutes}:${formattedSeconds}`;
    }
}

// Load video thumbnails regardless of authentication status
loadVideos();

// Optional: Monitor authentication status for additional features
onAuthStateChanged(auth, user => {
    if (user) {
        console.log('User is logged in.');
    } else {
        console.log('User is not logged in.');
    }
});

</script>
</body>
</html>



